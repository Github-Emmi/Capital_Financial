{% extends 'user_templates/base.html' %}
{% load static %}
{% block main_content %}
<div class="nk-content nk-content-fluid">
    {% for message in messages %}
    <div class="alert {{ message.tags }} alert-dismissible shadow fade show" role="alert">
        <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
        {{ message}}
    </div>
{% endfor %}
    <div class="container-xl wide-lg">
        <div class="nk-content-body">
            <div class="nk-block-head">
                <div class="nk-block-head-sub">
                </div>
                <div class="nk-block-between-md g-4 card-bordered">
                    <div class="nk-block-head-content">
                        <h4 class="nk-block-title fw-normal">Good morning {{user.get_full_name}} </h4>
                        <div class="nk-block-des">
                            <p>At a glance summary of your account!</p>
                        </div>
                    </div><!-- .nk-block-head-content -->
                    <div class="nk-block-head-content">
                        <ul class="nk-block-tools gx-3">
                            <li><a href="" class="btn btn-primary"><span>Deposit</span> <em class="icon ni ni-arrow-long-right"></em></a></li>
                            <li><a href="{% url 'adminapp:transfer' %}" class="btn btn-secondary btn-light text-light"><span>Transfer Fund</span> <em class="icon ni ni-arrow-long-right d-none d-sm-inline-block"></em></a></li>
                        </ul>
                    </div><!-- .nk-block-head-content -->
                </div><!-- .nk-block-between -->
            </div><!-- .nk-block-head -->
            <div class="nk-block">
                <div class="row gy-gs">
                    <div class="col-lg-6 col-xl-6">
                        <div class="nk-block">
                            <div class="nk-block-head-xs">
                                <div class="nk-block-head-content">
                                    <h5 class="nk-block-title title">Overview</h5>
                                </div>
                            </div><!-- .nk-block-head -->
                            <div class="nk-block">
                                <div class="card card-bordered text-light is-dark h-100">
                                    <div class="card-inner">
                                        <div class="nk-wg7">
                                            <div class="nk-wg7-stats-group">
                                                <div class="nk-wg7-stats w-50" style="background-image: url(); border-color: white; border-width: 5px; border-radius: 50%;">
                                                    <!-- {% if user.avatar %}   -->
                                                    
                                                    <img class="img img-rounded" src="media/{{ user.avatar }}" width="85" style="border-color: white; border-width: 5px; border-radius:50px;" height="85">
                                                    <!-- {% endif %}   -->
                                                
                                                </div>
                                            <div class="nk-wg7-stats w-50">
                                                <div class="nk-wg7-title">Available balance</div>
                                                <div class="number-lg amount">{{user.profile.Currency_type}} {{user.formatted_balance}}</div>
                                                {{user.get_full_name}}                                                            </div> 
                                            </div>
                                            
                                            <div class="nk-wg7-stats-group">
                                                <div class="nk-wg7-stats w-50">
                                                    <div class="nk-wg7-title">Linked Cards</div>
                                                    <div class="number-lg">{{card_len}}</div>
                                                </div>
                                               
                                            </div>
                                        </div><!-- .nk-wg7 -->
                                    </div><!-- .card-inner -->
                                </div><!-- .card -->
                            </div><!-- .nk-block -->
                        </div><!-- .nk-block -->
                    </div><!-- .col -->
                    
                     <div class="col-lg-6 col-xl-6">
                        <div class="nk-block">
                            <div class="nk-block-head-xs">
                                <div class="nk-block-between-md g-2">
                                    <div class="nk-block-head-content">
                                        <h5 class="nk-block-title title">{{user.profile.account_type}}</h5>
                                    </div>
                                    <div class="nk-block-head-content">
                                        <a href="{% url 'adminapp:transfer' %}" class="link link-primary">Transfer Fund</a>
                                    </div>
                                </div>
                            </div><!-- .nk-block-head -->
                            <div class="row g-2">
                                <div class="col-sm-12">
                                    <div class="card bg-light">
                                        <div class="nk-wgw sm">
                                            <a class="nk-wgw-inner" href="#">
                                                <div class="nk-wgw-name">
                                                    <div class="nk-wgw-icon">
                                                        <em class="icon ni ni-sign-cc-alt"></em>       </div>
                                                    <h5 class="nk-wgw-title title">{{card.card_number}}</h5>                                                
                                                </div>
                                                <div class="nk-wgw-balance">
                                                    <div class="amount">{{user.formatted_balance}}<span class="currency currency-nio">{{user.profile.Currency_type}}</span></div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </div><!-- .col -->
                            </div><!-- .row -->
                        </div><!-- .nk-block -->
                        <div class="nk-block nk-block-md">
                            <div class="nk-block-head-xs">
                                <div class="nk-block-between-md g-2">
                                    <div class="nk-block-head-content">
                                        <h6 class="nk-block-title title">Loans and lines of credit</h6>
                                    </div>
                                    <div class="nk-block-head-content">
                                        <a href="pay-bills" class="link link-primary">Pay bills</a>
                                    </div>
                                </div>
                            </div><!-- .nk-block-head -->
                            <div class="row g-2">
                                <div class="col-sm-6">
                                    <div class="card bg-light">
                                        <div class="nk-wgw sm">
                                            <a class="nk-wgw-inner" href="#">
                                                <div class="nk-wgw-name">
                                                    <div class="nk-wgw-icon">
                                                        <em class="icon ni ni-check-circle"></em>
                                                    </div>
                                                    <h5 class="nk-wgw-title title">Business Support Loan</h5>
                                                </div>
                                                <div class="nk-wgw-balance">
                                                    <div class="amount">+4,000<span class="currency currency-nio">USD</span></div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </div><!-- .col -->
                             
                                <div class="col-sm-6">
                                    <div class="card bg-light">
                                        <div class="nk-wgw sm">
                                            <a class="nk-wgw-inner" href="#">
                                                <div class="nk-wgw-name">
                                                    <div class="nk-wgw-icon">
                                                        <em class="icon ni ni-sign-cc-alt2"></em>
                                                    </div>
                                                    <h5 class="nk-wgw-title title"> FICO Credit Score</h5>
                                                </div>
                                                <div class="nk-wgw-balance">
                                                    <div class="amount text-dark">750 &nbsp;<span class="badge-pill bg-success"> </span></div>
                                                </div>
                                            </a>
                                        </div>
                                    </div>
                                </div><!-- .col -->
                            </div><!-- .row -->
                        </div> <!-- .nk-block -->
                    </div><!-- .col -->
                </div><!-- .row -->
            </div>
            <!-- .nk-block -->
             <div class="nk-block nk-block-lg">
                <div class="row gy-gs">
                    <div class="col-md-6">
                        <div class="card-head">
                            <div class="card-title  mb-0">
                                <h5 class="title">Recent Transaction Activities</h5>
                            </div>
                            <div class="card-tools">
                                <ul class="card-tools-nav">
                                    <li class="active"><a href="{% url 'adminapp:account_summary' %}">All</a></li>
                                </ul>
                            </div>
                        </div><!-- .card-head -->
                        <div class="tranx-list card card-bordered">
                  {% for account_data in account_data %}           

                            <div class="tranx-item">
                                <div class="tranx-col">
                                    <div class="tranx-info">
                                        <div class="tranx-data">
                                            <div class="tranx-label">CAP/{{account_data.txnId}}
                                                {% if account_data.txnType == 'Debit' %}
                                                <em class="tranx-icon sm icon ni ni-wallet-out"></em>
                                                {% elif account_data.txnType == 'Credit' %}
                                                <em class="tranx-icon sm icon ni ni-wallet-in"></em>

                                                {% endif %}
                                            </div>
                                            <div class="tranx-date">{{account_data.date}}</div>
                                            <div class="text-primary">{{account_data.action}}.</div>
                                        </div>
                                    </div>
                                </div>
                                {% if account_data.txnType == 'Credit' %}
                                <div class="tranx-col">
                                    <div class="tranx-amount">
                                        <div class="tranx-date">Amount</div>
                               <div class="text-success fs-16px">{{account_data.amount}} 
                                 <span class="currency currency-usd"><span class="currency currency-btc">{{user.profile.Currency_type}}</span></span></div>
                                        <div class="number-sm"><strong class="text-success">{{account_data.status}}</strong></div>
                                    </div>
                                </div>
                                {% elif account_data.txnType == 'Debit' %}
                                <div class="tranx-col">
                                    <div class="tranx-amount">
                                        <div class="tranx-date">Amount</div>
                               <div class="text-danger fs-16px">-{{account_data.amount}} 
                                 <span class="currency currency-usd"><span class="currency currency-btc">{{user.profile.Currency_type}}</span></span></div>
                                        <div class="number-sm"><strong class="text-danger">{{account_data.status}}</strong></div>
                                    </div>
                                </div>
                                {% endif %}

                                {% if account_data.txnType == 'Credit' %}
                                 <div class="tranx-col">
                                    <div class="tranx-amount">
                                        <div class="number text-success">{{account_data.txnType}}<span class="currency currency-btc"></span></div>
                                        <span class="badge badge-dim badge-pill badge-outline-primary" data-toggle="modal" data-target="#modalDefault1676">View Details</span>
                              </div>
                      </div>
                      {% elif account_data.txnType == 'Debit' %}
                                 <div class="tranx-col">
                                    <div class="tranx-amount">
                                        <div class="number text-danger">{{account_data.txnType}}<span class="currency currency-btc"></span></div>
                                        <span class="badge badge-dim badge-pill badge-outline-primary" data-toggle="modal" data-target="#modalDefault1676">View Details</span>
                              </div>
                      </div>
                      {% endif %}
             </div><!-- .tranx-item -->
<!-- .tranx-details -->
<div class="modal fade" tabindex="-1" id="modalDefault1676">
<div class="modal-dialog" role="document">
<div class="modal-content">
<div class="modal-header bg-primary text-light">
    <h5 class="modal-title text-light">Transaction Details</h5>
    <a href="#" class="close text-light" data-dismiss="modal" aria-label="Close">
        <em class="icon ni ni-cross"></em>
    </a>
</div>
<div class="modal-body">
      <ul class="buysell-overview-list">
                <li class="buysell-overview-item">
                <span class="pm-currency"><em class="icon ni ni-check-circle-fill"></em> <span>Amount:</span></span>
                    <span class="pm-title">{{user.profile.Currency_type}} {{account_data.amount}}</span>
                </li>
                 <li class="buysell-overview-item">
                <span class="pm-currency"><em class="icon ni ni-check-circle-fill"></em> <span>Transaction reference:</span></span>
                    <span class="pm-title">CAP/{{account_data.txnId}}</span>
                </li>
                <li class="buysell-overview-item">
                    <span class="pm-currency"><em class="icon ni ni-check-circle-fill"></em> <span>Description:</span></span>
                        <span class="pm-title">{{account_data.action}}.</span>
                    </li>
                                                                                <li class="buysell-overview-item">
                <span class="pm-currency"><em class="icon ni ni-check-circle-fill"></em> <span>Date:</span></span>
                    <span class="pm-title">{{account_data.date}}</span>
                </li>

                <li class="buysell-overview-item">
                <span class="pm-currency"><em class="icon ni ni-check-circle-fill"></em> <span>Available Balance:</span></span>
                    <span class="pm-title">{{user.profile.Currency_type}} {{user.formatted_balance}}</span>
                </li>
            </ul>
</div>
<div class="modal-footer bg-light">
    <span class="sub-text text-primary">Capital Funding Financial E-Service services.</span>
</div>
</div>
</div>
</div>

{% endfor %}           


                                                                  
                        </div><!-- .tranx-list -->
                    </div><!-- .col -->
                    <div class="col-md-6">
                        <div class="card-head">
                            <div class="card-title mb-0">
                                <h5 class="title">Balance Flow</h5>
                            </div>
                            <div class="card-tools">
                                <ul class="card-tools-nav">
                                    <li><a href="#">This Month</a></li>
                                    <li class="active"><a href="#">This Years</a></li>
                                </ul>
                            </div>
                        </div><!-- .card-title -->
                        <div class="card card-bordered">
                            <div class="card-inner">
                                <div class="nk-wg4">
                                    <div class="nk-wg4-group justify-center gy-3 gx-4">
                                        <div class="nk-wg4-item">
                                            <div class="sub-text">
                                                <div class="dot dot-lg sq" data-bg="#5ce0aa" style="background: rgb(92, 224, 170);"></div> <span>Received</span>
                                            </div>
                                        </div>
                                        <div class="nk-wg4-item">
                                            <div class="sub-text">
                                                <div class="dot dot-lg sq" data-bg="#798bff" style="background: rgb(121, 139, 255);"></div> <span>Sent</span>
                                            </div>
                                        </div>
                                        <div class="nk-wg4-item">
                                            <div class="sub-text">
                                                <div class="dot dot-lg sq" data-bg="#f6ca3e" style="background: rgb(246, 202, 62);"></div><span>Withdraw</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="nk-ck3">
                                    <div class="chartjs-size-monitor">
                                        <div class="chartjs-size-monitor-expand">
                                            <div class=""></div></div>
                                            <div class="chartjs-size-monitor-shrink"><div class=""></div></div></div>
                                    <canvas class="chart-account-summary chartjs-render-monitor" id="summaryBalance" style="display: block; height: 258px; width: 368px;" width="736" height="516"></canvas>
                                </div>
                            </div><!-- .card-inner -->
                        </div><!-- .card -->
<!-- TradingView Widget BEGIN -->
{% include "user_templates/includes/trading_view.html" %}
<!-- TradingView Widget END -->
      </div><!-- .col -->
                </div><!-- .row -->
            </div>
            <!-- .nk-block -->
            <div class="nk-block">
                <div class="card card-bordered">
                    <div class="card-inner card-inner-lg">
                        <div class="align-center flex-wrap flex-md-nowrap g-4">
                            <!-- svg -->
                            {% include "user_templates/includes/svg.html" %}
                            <!-- svg end-->

                            <div class="nk-block-content">
                                <div class="nk-block-content-head px-lg-4">
                                    <h5>Weâ€™re here to help you!</h5>
                                    <p class="text-soft">Ask a question or file a support ticket, manage request, report an issues. Our team support team will get back to you by email.</p>
                                </div>
                            </div>
                            <div class="nk-block-content flex-shrink-0">
                                <a href="contact" class="btn btn-lg btn-outline-primary">Get Support Now</a>
                            </div>
                        </div>
                    </div><!-- .card-inner -->
                </div><!-- .card -->
            </div><!-- .nk-block -->
        </div>
    </div>
</div>

{% endblock main_content %}